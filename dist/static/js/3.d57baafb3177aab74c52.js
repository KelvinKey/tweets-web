webpackJsonp([3],{UYKv:function(t,e){},kA1v:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("lC5x"),r=a.n(i),n=a("aA9S"),c=a.n(n),s=a("J0Oq"),o=a.n(s),u=a("4YfN"),l=a.n(u),d=a("AmmR"),p=a("48sp"),f={name:"Register",data:function(){return{user:null,captcha:{key:"",code:"",content:""},verificationKey:"",verificationCode:""}},created:function(){this.user=this.$route.params.user,this.loadCaptcha()},beforeRouteEnter:function(t,e,a){void 0===t.params.user&&a({name:"Register"}),a()},methods:l()({},Object(p.b)(["attemptRegister"]),{loadCaptcha:function(){var t=this;this.$http.post("auth/captcha?_="+Math.random(),{phone:this.user.phone}).then(function(e){t.captcha=e,t.captcha.code=""}).catch(function(){return t.$router.push({name:"Register"})})},sendVerificationCode:function(){var t=this;if(this.captcha.code.length<4)return d.a.showError(this.$refs.captchaInput,"请输入图片验证码");var e={captcha_key:this.captcha.key,captcha_code:this.captcha.code};this.$http.post("auth/verification",e).then(function(e){t.verificationKey=e.key,t.$message.success("短信验证码发送成功～")})},register:function(t){var e=this;this.$nextTick(function(){("submit"===t.target.type?t.target:t.target.parentElement).canSubmit&&e.submit()})},submit:function(){var t=this;return o()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={verification_key:t.verificationKey,verification_code:t.verificationCode},c()(a,t.user),e.next=4,t.attemptRegister(a);case 4:t.$message.success("注册成功！"),t.$router.push("/");case 6:case"end":return e.stop()}},e,t)}))()}})},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4 col-md-offset-4"},[a("div",{staticClass:"panel panel-default"},[a("div",{staticClass:"panel-body",attrs:{"data-validator-form":""}},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"control-label"},[t._v("验证手机号")]),t._v(" "),a("div",{staticStyle:{margin:"10px 0"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha.code,expression:"captcha.code"},{name:"validator",rawName:"v-validator:input.required",value:{regex:/^[a-zA-Z\d]+$/,error:"请输入图片验证码"},expression:"{ regex: /^[a-zA-Z\\d]+$/, error: '请输入图片验证码' }",arg:"input",modifiers:{required:!0}}],ref:"captchaInput",staticClass:"form-control",staticStyle:{width:"55%",float:"left"},attrs:{type:"text",placeholder:"请输入图片验证码"},domProps:{value:t.captcha.code},on:{input:function(e){e.target.composing||t.$set(t.captcha,"code",e.target.value)}}}),t._v(" "),a("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.loadCaptcha(e)}}},[a("img",{staticClass:"captcha",attrs:{src:t.captcha.content}})])]),t._v(" "),a("div",{staticClass:"form-inline"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.verificationCode,expression:"verificationCode",modifiers:{trim:!0}},{name:"validator",rawName:"v-validator:input.required",value:{regex:/^\d{4}$/,error:"请先输入验证码"},expression:"{ regex: /^\\d{4}$/, error: '请先输入验证码' }",arg:"input",modifiers:{required:!0}}],ref:"verificationInput",staticClass:"form-control",staticStyle:{width:"55%"},attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:t.verificationCode},on:{input:function(e){e.target.composing||(t.verificationCode=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("button",{staticClass:"btn btn-info",staticStyle:{"margin-left":"8px"},on:{click:t.sendVerificationCode}},[t._v("发送短信验证码")])])]),t._v(" "),a("button",{staticClass:"btn btn-lg btn-primary btn-block",attrs:{type:"submit"},on:{click:t.register}},[a("i",{staticClass:"fa fa-btn fa-user-plus"}),t._v(" 注 册\n        ")])])])])])},staticRenderFns:[]};var h=a("C7Lr")(f,v,!1,function(t){a("UYKv")},"data-v-453fb715",null);e.default=h.exports}});
//# sourceMappingURL=3.d57baafb3177aab74c52.js.map